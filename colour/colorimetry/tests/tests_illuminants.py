#!/usr/bin/env python
# -*- coding: utf-8 -*-

"""
Defines unit tests for :mod:`colour.colorimetry.illuminants` module.
"""

from __future__ import division, unicode_literals

import numpy as np
import unittest

from colour.colorimetry import (
    D_illuminant_relative_spd,
    CIE_standard_illuminant_A)

__author__ = 'Colour Developers'
__copyright__ = 'Copyright (C) 2013 - 2015 - Colour Developers'
__license__ = 'New BSD License - http://opensource.org/licenses/BSD-3-Clause'
__maintainer__ = 'Colour Developers'
__email__ = 'colour-science@googlegroups.com'
__status__ = 'Production'

__all__ = ['D60_SPD_DATA',
           'A_DATA',
           'TestD_illuminantRelativeSpd',
           'TestCIEStandardIlluminantA']

D60_SPD_DATA = {
    300: 0.02937075817492288549,
    310: 2.61924131796496295621,
    320: 15.71689061312826041217,
    330: 28.77458026391913392672,
    340: 31.86483993666197989114,
    350: 36.37742644467410002562,
    360: 38.68311546316286353431,
    370: 42.71754846183496567846,
    380: 41.45494057963752254636,
    390: 46.60531924327943187336,
    400: 72.27859383884863575531,
    410: 80.44059999279464534538,
    420: 82.91502693894318554158,
    430: 77.67626397731756071607,
    440: 95.68127430379398390414,
    450: 107.95482086750595840385,
    460: 109.55918680507406293145,
    470: 107.75814070682791623312,
    480: 109.67140423534179660692,
    490: 103.70787331005091402858,
    500: 105.23219857523204723293,
    510: 104.42766692185435317697,
    520: 102.52293357805245932468,
    530: 106.05267087904782385976,
    540: 103.31515403458197965847,
    550: 103.53859891732658127239,
    560: 100.00000000000000000000,
    570: 96.75142141886689728381,
    580: 96.71282250154031601141,
    590: 89.92147908442616710545,
    600: 91.99979329504407132845,
    610: 92.09870955067275133388,
    620: 90.64600269701034562786,
    630: 86.52648272486028702133,
    640: 87.57918623550152403823,
    650: 83.97614003583295527733,
    660: 84.72407422805771659569,
    670: 87.49349084772983076164,
    680: 83.48307015694973642894,
    690: 74.17245111876663088424,
    700: 76.62038531099138083391,
    710: 79.05184907375583236444,
    720: 65.47137071741646252576,
    730: 74.10607902725251960874,
    740: 79.52712042772630240961,
    750: 67.30716277162383676114,
    760: 49.27353820615909540948,
    770: 70.89241211789024532663,
    780: 67.16399622630497390219,
    790: 68.17137071741646536793,
    800: 62.98980861670580111422,
    810: 54.99089236107711542445,
    820: 60.82560067091316824417,
    830: 63.89349586226155963686}

A_DATA = np.array([
    6.14461778412385584147,
    6.94719898540207925208,
    7.82134941498168867469,
    8.76980228387608384821,
    9.79509960886738184627,
    10.89957615780163102670,
    12.08534536341113962976,
    13.35428725777771852279,
    14.70803844987550235146,
    16.14798414148025429427,
    17.67525215230304880265,
    19.29070890361035495175,
    20.99495729086599737911,
    22.78833636004295470912,
    24.67092268912794494895,
    26.64253336585088760557,
    28.70273044466300405020,
    30.85082676027945325359,
    33.08589297150250274626,
    35.40676570734002837071,
    37.81205668742749992361,
    40.30016269023955288731,
    42.86927624533729641598,
    45.51739692974648221480,
    48.24234315331340638977,
    51.04176432337019519991,
    53.91315328509929116763,
    56.85385894046740418162,
    59.86109895538908887147,
    62.93197247173279151866,
    66.06347274783063028281,
    69.25249965817168629201,
    72.49587198990484182559,
    75.79033948055132441368,
    79.13259454790964753101,
    82.51928366944945025807,
    85.94701837452933546047,
    89.41238581849036393123,
    92.91195891306121268371,
    96.44230599255287472715,
    100.00000000000000000000,
    103.58162718174091310175,
    107.18379528290080315855,
    110.80314123986994445659,
    114.43633836915748247520,
    118.08010305496281944215,
    121.73120094044466554806,
    125.38645263002221952320,
    129.04273891208509894568,
    132.69700551329364657249,
    136.34626739717154464415,
    139.98761262100404678677,
    143.61820576613078515038,
    147.23529095760173390772,
    150.83619448985839994748,
    154.41832707563108328941,
    157.97918573560303912018,
    161.51635534663245152842,
    165.02750986642087127620,
    168.51041325251125613249,
    171.96292009339430251202,
    175.38297596929947985700,
    178.76861755998513103805,
    182.11797251649284135055,
    185.42925911344599398944,
    188.70078569801850676413,
    191.93094995122592649750,
    195.11823797666437485532,
    198.26122323128703328621,
    201.35856531223905108163,
    204.40900861319713044395,
    207.41138086307174148715,
    210.36459155933297893171,
    213.26763030763547135393,
    216.11956507881058087150,
    218.91954039372544116304,
    221.66677544590908155442,
    224.36056217129291212586,
    227.00026327384375690599,
    229.58531021532814975217,
    232.11520117691731002196,
    234.58949899982891906802,
    237.00782911170330180539,
    239.36987744493731611328,
    241.67538835273725794650,
    243.92416252820845556926,
    246.11605493138202405135,
    248.25097272866656794577,
    250.32887324884100621603,
    252.34976195932119935605,
    254.31369046610311102086,
    256.22075454044096431971,
    258.07109217501573539266,
    259.86488167205436639051])


class TestD_illuminantRelativeSpd(unittest.TestCase):
    """
    Defines :func:`colour.colorimetry.illuminants.D_illuminant_relative_spd`
    definition unit tests methods.
    """

    def test_D_illuminant_relative_spd(self):
        """
        Tests :func:`colour.colorimetry.illuminants.D_illuminant_relative_spd`
        definition.
        """

        np.testing.assert_almost_equal(
            sorted(D_illuminant_relative_spd(
                np.array([0.32168, 0.33767])).data.values()),
            sorted(D60_SPD_DATA.values()),
            decimal=7)


class TestCIEStandardIlluminantA(unittest.TestCase):
    """
    Defines :func:`colour.colorimetry.illuminants.CIE_standard_illuminant_A`
    definition unit tests methods.
    """

    def test_CIE_standard_illuminant_A(self):
        """
        Tests :func:`colour.colorimetry.illuminants.CIE_standard_illuminant_A`
        definition.
        """

        np.testing.assert_almost_equal(
            CIE_standard_illuminant_A(np.arange(360, 830, 5)),
            A_DATA,
            decimal=7)


if __name__ == '__main__':
    unittest.main()
